
<!-----------------------------------JQUERY---------------------------------------------->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<style>
       .SearchWrapper {
              -webkit-box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              -moz-box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              border-bottom: solid black 1px;
              margin-bottom: 0.25em;
              padding-bottom: 0.25em;
              padding-top: 0.25em;
              border-radius: 1em;
              background-color: lightblue;
       }
       .SearchHead {
              -webkit-box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              -moz-box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              border-bottom: solid black 1px;
              border-radius: 0.5em;
              margin: 0.25em;
              background-color: #ffffff;
              width: auto;
       }
       .EntityWrapper {
              border-radius: 1em;
              -webkit-box-shadow: 0px 5px 7px 0px rgba(0,0,0,0.75);
              -moz-box-shadow: 0px 5px 7px 0px rgba(0,0,0,0.75);
              box-shadow: 0px 5px 7px 0px rgba(0,0,0,0.75);
              padding-bottom:1.25em;
              padding-top: 1.5em;
       }
       .AttributeWrapper {
              background-color: lightblue;
              border-radius: 0.5em;
              -webkit-box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              -moz-box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              box-shadow: 0px 0px 5px -1px rgba(0,0,0,0.75);
              padding: 0.25em;
              padding-bottom:1em;
       }



</style>

<div class = "mainContentWrapper">
       <div class = container-fluid>
              <h2> Hello! This is the CRUD plugin! </h2>
              <div></div></br>
              <button id="tail_world_redirect_button">Redirect to TailWorld!</button>
              <div
                      class="col-sm-12 col-md-12"
                      style="padding:0.5em;border: 0.1em solid black;"
              >
                     <input
                             id="jdbc_url"
                             style="width:100%"
                     ><br>
                     jdbc:sqlite:C:/sqlite/db/TailDB<br>
                     jdbc:sqlite:C:/sqlite/db/TestDB<br>
                     <button id="set_db_url_button">Set DB</button>
                     <div
                             id="set_db_url_response_box"
                             style="padding:0.5em;border: 0.1em solid black;"
                     >...response...</div>
              </div>
       </div>
</div>



<script>
       $(document).ready(function(){
              $('#tail_world_redirect_button').click(function() {
                     window.location = window.location.origin+'/tailworld.html';
              });
              $('#set_db_url_button').click(function() {
                     $('#set_db_url_response_box').load('CRUD/setJDBC?url='+$('#jdbc_url').val());
              });
       });

       function loadFoundForEntity( tableName ) {
              sendAndSet($('#' + tableName + '_search').children('input, textarea'), $('#' + tableName + '_result'), 'CRUD/find/' + tableName);
       }

       function loadSavedForEntity( tableName, id ) {
              let entity = $('#' + tableName+'_'+id);
              $( document ).ajaxComplete(function() {
                     console.log('Ajax complete: '+'#' + tableName+'_'+id+' !')
                     $('#' + tableName+'_'+id).children('div').children('.AttributeWrapper').children('textarea').first().focus();
              });
              console.log('Starting ajax for -> id: #' + tableName+'_'+id+'; url: '+'CRUD/save/' + tableName+' #' + tableName+'_'+id+' > *')
              sendAndSet(
                      entity.children('div').children('.AttributeWrapper').children('input, textarea'),
                      entity,
                      'CRUD/save/' + tableName+' #' + tableName+'_'+id+' > *'
              );
       }

       function sendAndSet(fromSelector, intoSelector, url) {
              var params = {};
              fromSelector.each(function () {
                     params[this.name] = this.value;
              });
              intoSelector.html("").load(url, params);
       }

       function noteOnInputFor( attribute, tableName, id )
       {
              let element = $('#'+attribute+'_'+id);
              element.attr('value',parseInt(element.attr('value'))+1);
              if( parseInt(element.attr('value'))>10 ) {
                     element.attr('value',0);
                     loadSavedForEntity(tableName, id);
              }
       }
</script>

